[{"name": "app.py", "content": "import plotly.express as px\nfrom shiny.express import input, ui\nfrom shinywidgets import output_widget, render_widget, render_plotly\nfrom shiny import render, reactive\nimport seaborn as sns\n\n# REDUNDANT CODE TO REMOVE - import palmerpenguins  # This package provides the Palmer Penguins dataset\nfrom palmerpenguins import load_penguins\n\nui.update_dark_mode(\"dark\")\n\n# Add a sidebar\nwith ui.sidebar(position=\"left\", bg=\"#181818\", open=\"open\"):\n    ui.update_dark_mode(\"dark\")\n    ui.h2(\"Sidebar\")  # Sidebar header\n    # Insert Drop-Down menu\n    ui.input_selectize(\n        id=\"selected_attribute\",\n        label=\"Selected Attribute\",\n        choices=[\"bill_length_mm\", \"bill_depth_mm\", \"flipper_length_mm\", \"body_mass_g\"],\n    )\n    # Insert Numeric Input field\n    ui.input_numeric(id=\"plotly_bin_count\", label=\"Bin Count (Plotly)\", value=5)\n    # Insert a slider input\n    ui.input_slider(\n        id=\"seaborn_bin_count\", label=\"Bin Count (Seaborn)\", min=3, max=21, value=7\n    )\n\n    # Insert checkbox filter for species\n    ui.input_checkbox_group(\n        id=\"selected_species_list\",\n        label=\"Species\",\n        choices=[\"Adelie\", \"Gentoo\", \"Chinstrap\"],\n        selected=[\"Adelie\", \"Gentoo\", \"Chinstrap\"],\n        inline=False,\n    )\n     # Insert checkbox filter for island\n    ui.input_checkbox_group(\n        id=\"selected_island_list\",\n        inline=True,\n        label=\"Islands\",\n        choices=[\"Torgerson\", \"Biscoe\", \"Dream\"],\n        selected=[\"Torgerson\", \"Biscoe\", \"Dream\"])\n    \n    # Inster a dividing line\n    ui.hr()\n    # Insert a link\n    ui.a(\n        \"Source code on GitHub\",\n        href=\"https://github.com/matthewpblock/cintel-02-data/tree/main\",\n        target=\"_blank\",\n    )\n\n# Main content\n\n# Use the built-in function to load the Palmer Penguins dataset\n# redundant code to remove - penguins_df = palmerpenguins.load_penguins()\npenguins = load_penguins()\n\nui.page_opts(title=\"Matt's Penguin Block\", fillable=True)  # Insert page header\nwith ui.layout_columns():  # Format into columns\n\n    with ui.card():\n        ui.card_header(\"Data Table\")\n\n        @render.data_frame\n        def penguins_dt():\n            return render.DataTable(filtered_data())\n\n    with ui.card():\n        ui.card_header(\"Data Grid\")\n\n        @render.data_frame\n        def penguins_dg():\n            return render.DataGrid(filtered_data())\n\n\nwith ui.layout_columns():  # Create a second row of columns\n\n    with ui.card(fill=True):\n        ui.card_header(\"Plotly Histogram\")\n\n        @render_widget\n        def plot1():\n            scatterplot = px.histogram(\n                data_frame=filtered_data(),\n                x=input.selected_attribute(),\n                nbins=input.plotly_bin_count(),\n            ).update_layout(\n                title={\"text\": \"Palmer Penguins\", \"x\": 0.5},\n                yaxis_title=\"Count\",\n                xaxis_title=input.selected_attribute(),\n            )\n            return scatterplot\n\n    with ui.card():\n        ui.card_header(\"Seaborn Histogram\")\n\n        @render.plot\n        def plot2():\n            ax = sns.histplot(\n                data=filtered_data(),\n                x=input.selected_attribute(),\n                bins=input.seaborn_bin_count(),\n            )\n            ax.set_title(\"Palmer Penguins\")\n            ax.set_xlabel(input.selected_attribute())\n            ax.set_ylabel(\"Number\")\n            return ax\n\n\n# Insert a Plotly Scatterplot (not in a column)\nwith ui.card(full_screen=True):\n    ui.card_header(\"Plotly Scatterplot: Species\")\n\n    @render_plotly\n    def plotly_scatterplot():\n        return px.scatter(\n            data_frame=filtered_data(),\n            x=\"bill_length_mm\",\n            y=\"bill_depth_mm\",\n            color=\"species\",\n            symbol=\"island\",\n            labels={\n                \"bill_depth_mm\": \"Bill Depth\",\n                \"bill_length_mm\": \"Bill Length\",\n                \"species\": \"Species\",\n                \"island\": \"Island\",\n            },\n        )\n\n\n# --------------------------------------------------------\n# Reactive calculations and effects\n# --------------------------------------------------------\n\n# Add a reactive calculation to filter the data\n# By decorating the function with @reactive, we can use the function to filter the data\n# The function will be called whenever an input functions used to generate that output changes.\n# Any output that depends on the reactive function (e.g., filtered_data()) will be updated when the data changes.\n\n\n@reactive.calc\ndef filtered_data():\n    isFilterMatch = penguins[\"species\"].isin(input.selected_species_list()) & penguins[\"island\"].isin(input.selected_island_list())\n    return penguins[isFilterMatch]\n", "type": "text"}]